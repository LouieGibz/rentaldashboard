<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Rental Income Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Firebase SDKs for a real-time, secure database -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously, signInWithCustomToken, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, doc, addDoc, deleteDoc, onSnapshot, collection, query, orderBy, setLogLevel, updateDoc } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        // Global variables provided by the Canvas environment. DO NOT change these.
        const firebaseConfig = JSON.parse(typeof __firebase_config !== 'undefined' ? __firebase_config : '{}');
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
        const initialAuthToken = typeof __initial_auth_token !== 'undefined' ? __initial_auth_token : null;

        // Initialize Firebase services
        let app, db, auth;
        let userId = null;
        let isAuthReady = false;
        let unsubscribe = () => {};
        
        setLogLevel('Debug');

        function initializeFirebase() {
            try {
                if (Object.keys(firebaseConfig).length > 0) {
                    app = initializeApp(firebaseConfig);
                    db = getFirestore(app);
                    auth = getAuth(app);
                    console.log("Firebase initialized successfully.");

                    onAuthStateChanged(auth, async (user) => {
                        if (user) {
                            userId = user.uid;
                            console.log("User authenticated:", userId);
                            isAuthReady = true;
                            document.getElementById('loading-indicator').classList.add('hidden');
                            document.getElementById('auth-container').classList.add('hidden');
                            document.getElementById('transaction-manager').classList.remove('hidden');
                            document.getElementById('app-id-display').textContent = `App ID: ${appId}`;
                            document.getElementById('user-id-display').textContent = `User ID: ${userId}`;
                            setupRealtimeListener();
                        } else {
                            console.log("User is not signed in, attempting anonymous login...");
                            if (initialAuthToken) {
                                await signInWithCustomToken(auth, initialAuthToken);
                            } else {
                                await signInAnonymously(auth);
                            }
                            isAuthReady = true;
                        }
                    });
                } else {
                    console.error("Firebase config is empty. Cannot initialize.");
                    document.getElementById('loading-indicator').textContent = "Firebase is not configured. Data will not be saved.";
                    document.getElementById('transaction-manager').classList.remove('hidden'); // Show manager for non-persistent mode
                }
            } catch (error) {
                console.error("Firebase initialization failed:", error);
                document.getElementById('loading-indicator').textContent = "Failed to connect to Firebase. Data will not be saved.";
                document.getElementById('transaction-manager').classList.remove('hidden'); // Show manager for non-persistent mode
            }
        }

        function setupRealtimeListener() {
            if (!db || !userId) {
                console.error("Firestore not initialized or user not authenticated. Cannot set up listener.");
                return;
            }

            const transactionsCollection = collection(db, `artifacts/${appId}/users/${userId}/transactions`);
            const q = query(transactionsCollection);

            unsubscribe = onSnapshot(q, (snapshot) => {
                const transactions = [];
                snapshot.forEach((doc) => {
                    transactions.push({ id: doc.id, ...doc.data() });
                });
                console.log("Transactions updated:", transactions);
                updateUI(transactions);
            }, (error) => {
                console.error("Error listening to Firestore:", error);
            });
        }

        function updateUI(transactions) {
            updateSummaryCards(transactions);
            updateTransactionTables(transactions);
            updateChart(transactions);
        }

        // Expose global functions to the rest of the script
        window.initializeFirebase = initializeFirebase;
        window.handleLogout = async () => {
            if (auth) {
                try {
                    unsubscribe();
                    await signOut(auth);
                    console.log("User signed out.");
                    window.location.reload();
                } catch (error) {
                    console.error("Error signing out:", error);
                }
            }
        };

        window.handleAddTransaction = async (e) => {
            e.preventDefault();
            if (!db || !userId) {
                console.error("Cannot add transaction: Firestore not initialized or user not authenticated.");
                return;
            }
            const form = document.getElementById('transaction-form');
            const formData = new FormData(form);
            const newTransaction = {
                type: formData.get('type'),
                date: formData.get('date'),
                description: formData.get('description'),
                amount: parseFloat(formData.get('amount')),
                tenant: formData.get('tenant') || null,
                category: formData.get('category') || null,
                timestamp: new Date()
            };

            try {
                const transactionsCollection = collection(db, `artifacts/${appId}/users/${userId}/transactions`);
                await addDoc(transactionsCollection, newTransaction);
                console.log("Transaction added successfully.");
                form.reset();
                window.toggleFormFields();
            } catch (error) {
                console.error("Error adding transaction:", error);
            }
        };

        window.handleUpdateTransaction = async (e) => {
            e.preventDefault();
            if (!db || !userId) {
                console.error("Cannot update transaction: Firestore not initialized or user not authenticated.");
                return;
            }
            const form = document.getElementById('edit-form');
            const docId = form.dataset.docId;
            const formData = new FormData(form);
            const updatedData = {
                type: formData.get('edit-type'),
                date: formData.get('edit-date'),
                description: formData.get('edit-description'),
                amount: parseFloat(formData.get('edit-amount')),
            };
            
            if (updatedData.type === 'income') {
                updatedData.tenant = formData.get('edit-tenant') || null;
                updatedData.category = null;
            } else {
                updatedData.category = formData.get('edit-category') || null;
                updatedData.tenant = null;
            }
            
            try {
                const docRef = doc(db, `artifacts/${appId}/users/${userId}/transactions`, docId);
                await updateDoc(docRef, updatedData);
                console.log("Transaction updated successfully.");
                closeModal();
            } catch (error) {
                console.error("Error updating transaction:", error);
            }
        };
        
        window.openEditModal = (transactionId, transactionType, transactionDate, transactionAmount, transactionTenant, transactionCategory, transactionDescription) => {
            const modal = document.getElementById('edit-modal');
            const form = document.getElementById('edit-form');
            
            document.getElementById('edit-type').value = transactionType;
            document.getElementById('edit-date').value = transactionDate;
            document.getElementById('edit-amount').value = transactionAmount;
            document.getElementById('edit-description').value = transactionDescription;
            
            form.dataset.docId = transactionId;
            
            if (transactionType === 'income') {
                document.getElementById('edit-tenant-field').classList.remove('hidden');
                document.getElementById('edit-category-field').classList.add('hidden');
                document.getElementById('edit-tenant').value = transactionTenant;
            } else {
                document.getElementById('edit-tenant-field').classList.add('hidden');
                document.getElementById('edit-category-field').classList.remove('hidden');
                document.getElementById('edit-category').value = transactionCategory;
            }
            
            modal.classList.remove('hidden');
        };

        window.closeModal = () => {
            const modal = document.getElementById('edit-modal');
            modal.classList.add('hidden');
        };

        window.handleTableAction = (e) => {
            if (!db || !userId) {
                console.error("Cannot perform action: Firestore not initialized or user not authenticated.");
                return;
            }
            const deleteBtn = e.target.closest('.delete-btn');
            const editBtn = e.target.closest('.edit-btn');
            
            if (deleteBtn) {
                 const docId = deleteBtn.dataset.id;
                 try {
                     const docRef = doc(db, `artifacts/${appId}/users/${userId}/transactions`, docId);
                     deleteDoc(docRef);
                     console.log("Transaction deleted successfully.");
                 } catch (error) {
                     console.error("Error deleting transaction:", error);
                 }
            } else if (editBtn) {
                const row = editBtn.closest('tr');
                const transaction = JSON.parse(decodeURIComponent(row.dataset.transaction));
                openEditModal(
                    transaction.id,
                    transaction.type,
                    transaction.date,
                    transaction.amount,
                    transaction.tenant,
                    transaction.category,
                    transaction.description
                );
            }
        };

        // These functions are now global
        window.updateSummaryCards = (transactions) => {
            const totalIncome = transactions.filter(t => t.type === 'income').reduce((sum, t) => sum + t.amount, 0);
            const totalExpenses = transactions.filter(t => t.type === 'expense').reduce((sum, t) => sum + t.amount, 0);
            const netProfit = totalIncome - totalExpenses;
            const currencyFormatter = new Intl.NumberFormat('en-PH', { style: 'currency', currency: 'PHP' });
            document.getElementById('totalIncome').textContent = currencyFormatter.format(totalIncome);
            document.getElementById('totalExpenses').textContent = currencyFormatter.format(totalExpenses);
            document.getElementById('netProfit').textContent = currencyFormatter.format(netProfit);
        };

        window.updateTransactionTables = (transactions) => {
            const incomeTbody = document.getElementById('income-tbody');
            const expensesTbody = document.getElementById('expenses-tbody');
            incomeTbody.innerHTML = '';
            expensesTbody.innerHTML = '';
            const currencyFormatter = new Intl.NumberFormat('en-PH', { style: 'currency', currency: 'PHP' });

            const sortedTransactions = transactions.sort((a, b) => new Date(b.date) - new Date(a.date));

            sortedTransactions.forEach(t => {
                const row = document.createElement('tr');
                row.className = "hover:bg-gray-50";
                row.dataset.transaction = encodeURIComponent(JSON.stringify(t));
                if (t.type === 'income') {
                    row.innerHTML = `
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${t.date}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${t.tenant}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${t.description}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-green-600 font-semibold text-right">${currencyFormatter.format(t.amount)}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium space-x-2">
                            <button data-id="${t.id}" class="edit-btn text-blue-600 hover:text-blue-900">Edit</button>
                            <button data-id="${t.id}" class="delete-btn text-red-600 hover:text-red-900">Delete</button>
                        </td>
                    `;
                    incomeTbody.appendChild(row);
                } else {
                    row.innerHTML = `
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${t.date}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${t.category}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${t.description}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-red-600 font-semibold text-right">${currencyFormatter.format(t.amount)}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium space-x-2">
                            <button data-id="${t.id}" class="edit-btn text-blue-600 hover:text-blue-900">Edit</button>
                            <button data-id="${t.id}" class="delete-btn text-red-600 hover:text-red-900">Delete</button>
                        </td>
                    `;
                    expensesTbody.appendChild(row);
                }
            });
        };

        let chart;

        function prepareChartData(transactions) {
            const monthlyData = {};
            transactions.forEach(t => {
                const month = t.date.substring(0, 7);
                if (!monthlyData[month]) {
                    monthlyData[month] = { income: 0, expense: 0 };
                }
                monthlyData[month][t.type] += t.amount;
            });
            const sortedMonths = Object.keys(monthlyData).sort();
            return {
                labels: sortedMonths.map(month => new Date(month + '-02').toLocaleString('default', { month: 'long', year: 'numeric' })),
                incomeData: sortedMonths.map(month => monthlyData[month].income),
                expenseData: sortedMonths.map(month => monthlyData[month].expense),
            };
        }

        window.updateChart = (transactions) => {
            const { labels, incomeData, expenseData } = prepareChartData(transactions);
            if (!chart) {
                const ctx = document.getElementById('incomeExpenseChart').getContext('2d');
                const currencyFormatter = new Intl.NumberFormat('en-PH', { style: 'currency', currency: 'PHP' });
                chart = new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: labels,
                        datasets: [
                            { label: 'Income', data: incomeData, backgroundColor: 'rgba(52, 211, 153, 0.7)', borderColor: 'rgba(5, 150, 105, 1)', borderWidth: 1, borderRadius: 4 },
                            { label: 'Expenses', data: expenseData, backgroundColor: 'rgba(239, 68, 68, 0.7)', borderColor: 'rgba(185, 28, 28, 1)', borderWidth: 1, borderRadius: 4 }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: {
                                beginAtZero: true,
                                ticks: { callback: (value) => currencyFormatter.format(value).replace('₱', '₱ ') }
                            },
                            x: { grid: { display: false } }
                        },
                        plugins: {
                            tooltip: {
                                callbacks: {
                                    label: (context) => {
                                        let label = context.dataset.label || '';
                                        if (label) label += ': ';
                                        if (context.parsed.y !== null) label += currencyFormatter.format(context.parsed.y);
                                        return label;
                                    }
                                }
                            }
                        }
                    }
                });
            } else {
                chart.data.labels = labels;
                chart.data.datasets[0].data = incomeData;
                chart.data.datasets[1].data = expenseData;
                chart.update();
            }
        };

        // Functions and event listeners moved into the module scope
        function toggleFormFields() {
            const typeSelect = document.getElementById('type');
            const tenantField = document.getElementById('tenant-field');
            const categoryField = document.getElementById('category-field');

            if (typeSelect.value === 'income') {
                tenantField.classList.remove('hidden');
                categoryField.classList.add('hidden');
            } else {
                tenantField.classList.add('hidden');
                categoryField.classList.remove('hidden');
            }
        }
        
        window.toggleFormFields = toggleFormFields;

        function showTab(type) {
            const incomeTab = document.getElementById('income-tab');
            const expensesTab = document.getElementById('expenses-tab');
            const incomeTableContainer = document.getElementById('income-table-container');
            const expensesTableContainer = document.getElementById('expenses-table-container');

            if (type === 'income') {
                incomeTab.classList.add('active');
                expensesTab.classList.remove('active');
                incomeTableContainer.classList.remove('hidden');
                expensesTableContainer.classList.add('hidden');
            } else {
                incomeTab.classList.remove('active');
                expensesTab.classList.add('active');
                incomeTableContainer.classList.add('hidden');
                expensesTableContainer.classList.remove('hidden');
            }
        }
        
        document.addEventListener('DOMContentLoaded', () => {
            const typeSelect = document.getElementById('type');
            const incomeTab = document.getElementById('income-tab');
            const expensesTab = document.getElementById('expenses-tab');

            // Set up event listeners
            typeSelect.addEventListener('change', toggleFormFields);
            incomeTab.addEventListener('click', () => showTab('income'));
            expensesTab.addEventListener('click', () => showTab('expenses'));
            
            // Listen for clicks on the table bodies to handle delete and edit buttons
            document.getElementById('income-tbody').addEventListener('click', window.handleTableAction);
            document.getElementById('expenses-tbody').addEventListener('click', window.handleTableAction);

            // Initial setup
            toggleFormFields();
            showTab('income');
            
            // Initialize Firebase
            window.initializeFirebase();
        });
    </script>
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #F9F9F7; color: #383838; }
        .chart-container { position: relative; width: 100%; max-width: 900px; margin-left: auto; margin-right: auto; height: 300px; max-height: 40vh; }
        @media (min-width: 768px) { .chart-container { height: 400px; } }
        .stat-card { background-color: #FFFFFF; border: 1px solid #E5E5E3; border-radius: 0.75rem; padding: 1.5rem; text-align: center; transition: transform 0.2s, box-shadow 0.2s; }
        .stat-card:hover { transform: translateY(-5px); box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.05), 0 4px 6px -2px rgba(0, 0, 0, 0.05); }
        .btn { transition: background-color 0.3s; }
        .tab-btn { transition: all 0.3s; border-bottom: 2px solid transparent; }
        .tab-btn.active { border-color: #A47F6A; color: #A47F6A; font-weight: 600; }
        .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.5); z-index: 999; display: flex; justify-content: center; align-items: center; }
        .message-modal { position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); z-index: 1000; background-color: white; padding: 20px; border-radius: 10px; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); text-align: center; }
    </style>
</head>
<body class="antialiased">
    <div class="container mx-auto p-4 md:p-8 max-w-7xl">
        <header class="mb-8">
            <h1 class="text-4xl font-bold text-gray-800">Rental Income Dashboard</h1>
            <p id="app-id-display" class="text-xs text-gray-400 mt-1"></p>
            <p id="user-id-display" class="text-xs text-gray-400 mt-1"></p>
        </header>

        <main>
            <section id="summary-cards" class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="stat-card">
                    <h3 class="text-md font-medium text-gray-500">Total Income</h3>
                    <p id="totalIncome" class="text-4xl font-bold text-green-600 mt-2">₱0.00</p>
                </div>
                <div class="stat-card">
                    <h3 class="text-md font-medium text-gray-500">Total Expenses</h3>
                    <p id="totalExpenses" class="text-4xl font-bold text-red-600 mt-2">₱0.00</p>
                </div>
                <div class="stat-card">
                    <h3 class="text-md font-medium text-gray-500">Net Profit</h3>
                    <p id="netProfit" class="text-4xl font-bold text-blue-600 mt-2">₱0.00</p>
                </div>
            </section>

            <section id="chart-section" class="bg-white p-6 rounded-xl border border-gray-200 shadow-sm mb-8">
                <h2 class="text-2xl font-semibold text-gray-700 mb-4">Monthly Overview</h2>
                 <p class="text-gray-600 mb-4">This chart provides a visual comparison of your total income and expenses for each month. Hover over the bars to see the exact amounts for each category, helping you to quickly identify trends in your property's financial performance.</p>
                <div class="chart-container">
                    <canvas id="incomeExpenseChart"></canvas>
                </div>
            </section>
            
            <div id="loading-indicator" class="text-center py-8 text-gray-500">Loading and authenticating...</div>

            <div id="auth-container" class="hidden">
                 <div class="bg-white p-6 rounded-xl border border-gray-200 shadow-sm mt-8 max-w-lg mx-auto">
                    <h2 class="text-xl font-semibold text-gray-700 mb-4">You are not authenticated.</h2>
                    <p class="text-gray-600 mb-4">Your data will not be saved permanently. Please log in to enable data saving.</p>
                </div>
            </div>

            <div id="transaction-manager" class="hidden">
                 <div class="flex justify-between items-center mt-8 mb-4">
                    <h2 class="text-3xl font-semibold text-gray-700">Owner Tools</h2>
                    <button id="logout-btn" onclick="handleLogout()" class="btn bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-2 px-4 rounded-lg">Log Out</button>
                </div>
                <section id="transactions-section" class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                    <div class="lg:col-span-2 bg-white p-6 rounded-xl border border-gray-200 shadow-sm">
                        <h2 class="text-2xl font-semibold text-gray-700 mb-4">Transaction History</h2>
                         <p class="text-gray-600 mb-4">Here you can view a detailed list of all your income and expense transactions. Use the tabs to switch between views. You can edit any transaction by clicking the 'Edit' button or remove it by clicking the 'Delete' button next to it.</p>
                        <div class="border-b border-gray-200">
                            <nav class="-mb-px flex space-x-6" aria-label="Tabs">
                                <button id="income-tab" class="tab-btn active py-4 px-1 text-lg font-medium text-gray-500 hover:text-gray-700">Income</button>
                                <button id="expenses-tab" class="tab-btn py-4 px-1 text-lg font-medium text-gray-500 hover:text-gray-700">Expenses</button>
                            </nav>
                        </div>
                        
                        <div id="income-table-container" class="mt-6">
                            <div class="overflow-x-auto">
                                <table class="min-w-full divide-y divide-gray-200">
                                    <thead class="bg-gray-50">
                                        <tr>
                                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Date</th>
                                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Tenant</th>
                                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Description</th>
                                            <th scope="col" class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">Amount</th>
                                            <th scope="col" class="relative px-6 py-3"><span class="sr-only">Actions</span></th>
                                        </tr>
                                    </thead>
                                    <tbody id="income-tbody" class="bg-white divide-y divide-gray-200">
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        
                        <div id="expenses-table-container" class="hidden mt-6">
                             <div class="overflow-x-auto">
                                <table class="min-w-full divide-y divide-gray-200">
                                    <thead class="bg-gray-50">
                                        <tr>
                                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Date</th>
                                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Category</th>
                                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Description</th>
                                            <th scope="col" class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">Amount</th>
                                            <th scope="col" class="relative px-6 py-3"><span class="sr-only">Actions</span></th>
                                        </tr>
                                    </thead>
                                    <tbody id="expenses-tbody" class="bg-white divide-y divide-gray-200">
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    <div class="bg-white p-6 rounded-xl border border-gray-200 shadow-sm h-fit">
                        <h2 class="text-2xl font-semibold text-gray-700 mb-4">Add Transaction</h2>
                        <p class="text-gray-600 mb-4">Use this form to add a new income or expense item. The dashboard will update automatically once you submit the entry.</p>
                        <form id="transaction-form" onsubmit="handleAddTransaction(event)" class="space-y-4">
                            <div>
                                <label for="type" class="block text-sm font-medium text-gray-700">Type</label>
                                <select id="type" name="type" class="mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-[#A47F6A] focus:border-[#A47F6A] sm:text-sm rounded-md">
                                    <option value="income">Income</option>
                                    <option value="expense">Expense</option>
                                </select>
                            </div>
                            <div>
                                <label for="date" class="block text-sm font-medium text-gray-700">Date</label>
                                <input type="date" name="date" id="date" required class="mt-1 focus:ring-[#A47F6A] focus:border-[#A47F6A] block w-full shadow-sm sm:text-sm border-gray-300 rounded-md">
                            </div>
                            <div id="tenant-field">
                                <label for="tenant" class="block text-sm font-medium text-gray-700">Tenant Name</label>
                                <input type="text" name="tenant" id="tenant" class="mt-1 focus:ring-[#A47F6A] focus:border-[#A47F6A] block w-full shadow-sm sm:text-sm border-gray-300 rounded-md">
                            </div>
                            <div id="category-field" class="hidden">
                                <label for="category" class="block text-sm font-medium text-gray-700">Category</label>
                                <input type="text" name="category" id="category" value="Utilities" class="mt-1 focus:ring-[#A47F6A] focus:border-[#A47F6A] block w-full shadow-sm sm:text-sm border-gray-300 rounded-md">
                            </div>
                            <div>
                                <label for="description" class="block text-sm font-medium text-gray-700">Description</label>
                                <input type="text" name="description" id="description" required class="mt-1 focus:ring-[#A47F6A] focus:border-[#A47F6A] block w-full shadow-sm sm:text-sm border-gray-300 rounded-md">
                            </div>
                            <div>
                                <label for="amount" class="block text-sm font-medium text-gray-700">Amount (PHP)</label>
                                <input type="number" name="amount" id="amount" required min="0" step="0.01" class="mt-1 focus:ring-[#A47F6A] focus:border-[#A47F6A] block w-full shadow-sm sm:text-sm border-gray-300 rounded-md">
                            </div>
                            <button type="submit" class="w-full btn bg-[#A47F6A] hover:bg-[#8e6b56] text-white font-bold py-2 px-4 rounded-lg">Add Transaction</button>
                        </form>
                    </div>
                </section>
            </div>
        </main>
    </div>

    <!-- Edit Modal -->
    <div id="edit-modal" class="hidden modal-overlay">
        <div class="bg-white p-6 rounded-xl border border-gray-200 shadow-xl max-w-md w-full">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-xl font-semibold text-gray-700">Edit Transaction</h3>
                <button onclick="closeModal()" class="text-gray-400 hover:text-gray-600">&times;</button>
            </div>
            <form id="edit-form" onsubmit="handleUpdateTransaction(event)" class="space-y-4">
                <div>
                    <label for="edit-type" class="block text-sm font-medium text-gray-700">Type</label>
                    <input type="text" name="edit-type" id="edit-type" readonly class="mt-1 block w-full pl-3 pr-10 py-2 text-base bg-gray-100 border-gray-300 rounded-md">
                </div>
                <div>
                    <label for="edit-date" class="block text-sm font-medium text-gray-700">Date</label>
                    <input type="date" name="edit-date" id="edit-date" required class="mt-1 focus:ring-[#A47F6A] focus:border-[#A47F6A] block w-full shadow-sm sm:text-sm border-gray-300 rounded-md">
                </div>
                <div id="edit-tenant-field">
                    <label for="edit-tenant" class="block text-sm font-medium text-gray-700">Tenant Name</label>
                    <input type="text" name="edit-tenant" id="edit-tenant" class="mt-1 focus:ring-[#A47F6A] focus:border-[#A47F6A] block w-full shadow-sm sm:text-sm border-gray-300 rounded-md">
                </div>
                <div id="edit-category-field" class="hidden">
                    <label for="edit-category" class="block text-sm font-medium text-gray-700">Category</label>
                    <input type="text" name="edit-category" id="edit-category" class="mt-1 focus:ring-[#A47F6A] focus:border-[#A47F6A] block w-full shadow-sm sm:text-sm border-gray-300 rounded-md">
                </div>
                <div>
                    <label for="edit-description" class="block text-
